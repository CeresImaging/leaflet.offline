!function e(t,i,o){function n(l,s){if(!i[l]){if(!t[l]){var a="function"==typeof require&&require;if(!s&&a)return a(l,!0);if(r)return r(l,!0);var f=new Error("Cannot find module '"+l+"'");throw f.code="MODULE_NOT_FOUND",f}var c=i[l]={exports:{}};t[l][0].call(c.exports,function(e){var i=t[l][1][e];return n(i?i:e)},c,c.exports,e,t,i,o)}return i[l].exports}for(var r="function"==typeof require&&require,l=0;l<o.length;l++)n(o[l]);return n}({1:[function(e,t,i){var o=e("./localforage");L.Control.SaveTiles=L.Control.extend({options:{position:"topleft",saveText:"+",rmText:"-",confirm:null},initialize:function(e,t){this._baseLayer=e,L.setOptions(this,t)},setLayer:function(e){this._baseLayer=e},onAdd:function(){var e=L.DomUtil.create("div","savetiles leaflet-bar"),t=this.options;return this._createButton(t.saveText,"Save tiles","savetiles",e,this._saveTiles),this._createButton(t.rmText,"Remove tiles","rmtiles",e,this._rmTiles),e},_createButton:function(e,t,i,o,n){var r=L.DomUtil.create("a",i,o);return r.innerHTML=e,r.href="#",r.title=t,L.DomEvent.on(r,"mousedown dblclick",L.DomEvent.stopPropagation).on(r,"click",L.DomEvent.stop).on(r,"click",n,this).on(r,"click",this._refocusOnMap,this),r},_saveTiles:function(){var e,t=[],i=this.options.zoomlevels||[this._map.getZoom()],o=this._map.getBounds();for(var n in i)e=L.bounds(this._map.project(o.getNorthWest(),i[n]),this._map.project(o.getSouthEast(),i[n])),t=t.concat(this._baseLayer.getTileUrls(e,i[n]));this._tilesforSave=t;var r=this,l=function(){r._baseLayer.fire("savestart",r),r._loadTile(r._tilesforSave.shift())};this.options.confirm?this.options.confirm(this,l):l()},_loadTile:function(e){var t=this,i=new XMLHttpRequest;i.open("GET",e.url),i.responseType="blob",i.send(),i.onreadystatechange=function(){4===this.readyState&&200===this.status&&(t._saveTile(e.key,this.response),t._tilesforSave.length>0?(t._loadTile(t._tilesforSave.shift()),t._baseLayer.fire("loadtileend")):(t._baseLayer.fire("loadtileend"),t._baseLayer.fire("loadend")))}},_saveTile:function(e,t){var i=this;o.removeItem(e).then(function(){o.setItem(e,t).then(function(){i._baseLayer.fire("savetileend",i)}).catch(function(e){throw new Error(e)})}).catch(function(e){throw new Error(e)})},onRemove:function(){},_rmTiles:function(){var e=this;o.clear().then(function(){e._baseLayer.fire("tilesremoved")})}}),L.control.savetiles=function(e,t){return new L.Control.SaveTiles(e,t)}},{"./localforage":4}],2:[function(e,t,i){var o=e("./localforage");L.TileLayer.Offline=L.TileLayer.extend({options:{zoomlevels:null},diffZoom:1,createTile:function(e,t){var i=document.createElement("img");return L.DomEvent.on(i,"load",L.bind(this._tileOnLoad,this,t,i)),L.DomEvent.on(i,"error",L.bind(this._tileOnError,this,t,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",i.setAttribute("role","presentation"),this.getTileUrl(e).then(function(e){i.src=e}).catch(function(e){throw new Error(e)}),i},getTileUrl:function(e){var t=this,i=new Promise(function(i,n){var r=L.TileLayer.prototype.getTileUrl.call(t,e);o.getItem(r).then(function(e){e&&"object"==typeof e&&i(URL.createObjectURL(e)),i(r)}).catch(function(e){n(e)})});return i},getTileUrls:function(e,t){for(var i=[],o=this._url,n=L.bounds(e.min.divideBy(this.getTileSize().x).floor(),e.max.divideBy(this.getTileSize().x).floor()),r=n.min.y;r<=n.max.y;r++)for(var l=n.min.x;l<=n.max.x;l++){var s=new L.Point(l,r);this.setUrl(this._url.replace("{z}",t),!0),i.push({key:L.TileLayer.prototype.getTileUrl.call(this,s),url:L.TileLayer.prototype.getTileUrl.call(this,s)})}return this.setUrl(o,!0),i}}),L.tileLayer.offline=function(e,t){return new L.TileLayer.Offline(e,t)}},{"./localforage":4}],3:[function(e,t,i){e("./Control.SaveTiles"),e("./TileLayer.Offline")},{"./Control.SaveTiles":1,"./TileLayer.Offline":2}],4:[function(e,t,i){(function(e){var i="undefined"!=typeof window?window.localforage:"undefined"!=typeof e?e.localforage:null;i.config({name:"leaflet_offline",version:1,size:4980736,storeName:"tiles",description:"the tiles"}),t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[3]);